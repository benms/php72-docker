version: '3'

networks:
 internal:
  driver: bridge
  ipam:
    driver: default
    config:
      - subnet: 192.168.220.0/28
 shared:
  external:
   name: mysql_net

services:
  php:
     build:
      context: ./conf
     working_dir: /var/www/html
     container_name: php72_apache
     restart: always
     volumes:
       - ${WEB_DATA_PATH:-./data}:/var/www/html
       - ./conf/php.ini:/usr/local/etc/php/php.ini
       - ./conf/xhprof.conf:/etc/apache2/sites-enabled/xhprof.conf
       - ./conf/xhprof_log:/var/log/xhprof_log
     ports:
      - ${WEB_HOST_PORT:-81}:80
     env_file:
      - ./conf/.env
     logging:
      driver: json-file
      options:
        max-file: '5'
        max-size: 50m
     networks:
      - internal
      - shared
     
